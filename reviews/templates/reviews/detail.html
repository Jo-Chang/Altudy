{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block content %}
<h1>{{ problem.title }}</h1>
<h4>{{ problem.user }}</h4>
<p>{{ problem.url }}</p>
<p>{{ problem.description|markdown }}</p>

{# 좋아요 #}
{% include 'reviews/components/like.html' with obj=problem %}

<hr>
<div>
  <a href="{% url 'reviews:review_create' problem.pk %}">리뷰 작성하기</a>
</div>
<form action="{% url 'reviews:delete' problem.pk %}" method="post">
  {% csrf_token %}
  <button type="submit">문제 삭제</button>
</form>
<hr>
<ul>
  {% for review in problem.review_set.all %}
  <li>{{ review.content|markdown }}</li>
  
  {# 좋아요 #}
  {% include 'reviews/components/like.html' with obj=review %}
  
  <form action="{% url 'reviews:review_update' review.pk %}" method="post">
    {% csrf_token %}
    <button type="submit">리뷰 수정</button>
  </form>
  <hr>
  <a href="{% url 'reviews:comment_create' review.pk %}">댓글 작성</a>
  <ul>
    {% for comment in review.comment_set.all %}
    <li>{{ comment.content|markdown }}</li>
    <form action="{% url 'reviews:comment_update' comment.pk %}" method="post">
      {% csrf_token %}
      <button type="submit">댓글 수정</button>
    </form>
    <form action="{% url 'reviews:comment_delete' comment.pk %}" method="post">
      {% csrf_token %}
      <button type="submit">댓글 삭제</button>
    </form>
    
    {# 좋아요 #}
    {% include 'reviews/components/like.html' with obj=comment %}
    
    {% endfor %}
  </ul>
  {% endfor %}
</ul>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="{% static 'reviews/like.js' %}"></script>
{% endblock content %}